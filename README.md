# message-demo
基于阿里短信发送Demo
开源一个阿里短信发送的Demo（主要实现发送，回调功能）
里面并没使用到什么高级技术，大神可以直接绕道，也可检查批评指出不好的地方，感谢指导。
从这开始：
vinc-message-demo:1.4
涉及功能和技术（和坑）：(写得笔记简陋)
（自定义模板，参数，号码）用于批量发送同样内容的短信。
（自定义独立，模板，参数）用于单发和批量单发，每条都不一样的短信。
记录发送状态，发送前入库，先入库记录数据后再进行异步发送。
发送完成，进行回调并更新短信状态，（延迟较高）可能拿不到。失败的话导致该条短信会一直保持等待回执状态状态。
只有发送中状态的数据才能回调，手动选择号码列表再次进行回调（坑）一直回调失败的话？这种情况怎么办呢？重新发送？还是进行定时扫描检查回调状态？
异步返回结果后再进行回调如入库，时间比较久。
涉及细节：
加密：暂时没有怎么研究加密方式和算法，这里面只有一个最简单的Base64（自定义字符串+日期）最基础的接口内限制而已。
数据库：Elasticsearch或者mysql,这个版本只有mysql数据库的。
博主在公司使用Elasticsearch数据库实现了，但是家里没装Elasticsearch(其实是不会装)，所以换到了mysql，并且进行了完善和优化。
其实还有很多地方没做好，后续继续优化。
环境：
idea:IntelliJ IDEA 2017.3.4 x64
springBoot:2.1.1
mysql:5.6.40
gradle:4.9
主要包：
aliyun-java-sdk-core,version: '4.1.1'
aliyun-java-sdk-dysmsapi,version: '1.1.0'
mysql-connector-java, version: '6.0.6'
spring-boot-starter-data-jpa, version: '2.1.1.RELEASE'
配置文件：下个版本加
阿里账号里面的：accessKeyId，accessKeySecret——（暂时没做需要在实现类中修改）
各位读者不好意思本人前端技术不太好做不出狂拽炫酷吊炸天的操作界面，所以这里面只是接口和功能的实现而已，并没有操作页面。
如果有大牛有空帮我弄个漂亮的前端页面那就好了，我也会上传到这里。
只有postman测试：

批量发送短信



获取短信发送结果
建议优化功能：
1.加入redis（单个号码回调超过限制，直接修改状态为：**号码回调次数过多，请24小时后再试，加个定时任务每天凌晨把所有发送中状态的信息进行一遍回调。连续失败10天后填入数据库,错误回调表中，并且发送表状态是异常，开发人员可以对这种表的数据进行单一排查（已有测试类），然后再分析原因），也可交给维护人员；
2.配置文件可以写到缓存中，这样子能实时更新配置，又不用重新部署项目，暂用资源又少，只需要加个接口去维护下，刷新缓存；
3.加入权限，一个用户一天可以发多少条短信，运维人:员可以查看错误回调表中的数据，并且有单独功能查看到底什么原因失败，再统计进行反馈；
4.对同一个号码每天，每周，每月发送限制条数；
5.加密，由个人技术而定（重点）；
6.加入日志（重点），博主太懒没加，推荐使用slf4j；
7.记录IP，使用频率；
等等。。。。。。
博主肯定不会做这么麻烦，后续版本再慢慢进行优化改进。大家有时间的话，可以给我点优化建议，谢谢大家。
就一个发送短信有必要这么复杂么？有多少公司会做得这么复杂呢？（这一点由于博主工作经验太少，还没遇到过，但估计是会有的）如果公司想要开发一个非常复杂的功能，但是所花费的时间，成本，和这一个功能所得到的收益并不是正比的话，估计这东西是很难落地的。不过对于个人成长还是有一定帮助的，何况如果是短信发送功能的话，博主已经写好，并且开放源码，各位读者下载就能直接使用。
最后我个人觉得这个嘛，看人，反正博主近期没时间优化的了。而上面这是一个个人代码的追求和编码思路历程，不过这里面个人感觉还真的有点过分设计了！源码已对大家开放，大家可以随便改。也可把实现抽出来单独使用。
欢迎吐槽和技术探讨
github地址

以上纯属个人原创与总结，手打真累，如需转载请注明来源，谢谢。
jpa参考链接，觉得写得很好：SpringBoot----利用JpaRepository实现数据的增删查改
